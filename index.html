<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Guia T√©cnico ‚Äî Naruto no Multiverso</title>
  <style>
    :root{--bg:#0b1020;--card:#151e2e;--accent:#ff9f43;--accent-glow:rgba(255,159,67,0.15);--muted:#8b9bb4;--text:#e6eef8;--code-bg:#0d1117}
    body{font-family:'Inter',system-ui,-apple-system,sans-serif;margin:0;background:linear-gradient(180deg,#071025 0%, #050b1a 100%);color:var(--text);line-height:1.6}
    
    /* Layout */
    header{padding:20px 28px;border-bottom:1px solid rgba(255,255,255,0.05);display:flex;align-items:center;gap:16px;background:rgba(11,16,32,0.95);backdrop-filter:blur(10px);position:sticky;top:0;z-index:100;box-shadow:0 4px 20px rgba(0,0,0,0.3)}
    .logo{width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,#ff9f43,#ff6b6b);display:flex;align-items:center;justify-content:center;font-weight:800;color:#fff;font-size:20px;box-shadow:0 4px 12px var(--accent-glow)}
    h1{font-size:20px;margin:0;font-weight:700;letter-spacing:-0.5px}
    .container{display:flex;gap:32px;padding:32px;max-width:1400px;margin:0 auto}
    
    /* Nav */
    nav{width:300px;min-width:300px;position:sticky;top:100px;height:fit-content;max-height:80vh;overflow-y:auto}
    .nav-card{background:var(--card);border-radius:16px;padding:16px;border:1px solid rgba(255,255,255,0.05);box-shadow:0 4px 12px rgba(0,0,0,0.2)}
    .nav-list{list-style:none;padding:0;margin:0}
    .nav-list li{margin-bottom:6px}
    .nav-list button{width:100%;text-align:left;padding:12px 16px;border-radius:10px;border:0;background:transparent;color:var(--muted);cursor:pointer;transition:all 0.2s;font-size:14px;font-weight:500;display:flex;align-items:center;gap:10px}
    .nav-list button:hover{background:rgba(255,255,255,0.03);color:var(--text);transform:translateX(4px)}
    .nav-list button.active{background:linear-gradient(90deg, rgba(255,159,67,0.1) 0%, transparent 100%);color:var(--accent);font-weight:600;border-left:3px solid var(--accent)}
    
    /* Main Content */
    main{flex:1;min-height:80vh}
    section{display:none;animation:fadeIn 0.4s cubic-bezier(0.16, 1, 0.3, 1)}
    section.active{display:block}
    @keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
    
    h2{margin-top:0;font-size:28px;border-bottom:1px solid rgba(255,255,255,0.05);padding-bottom:20px;margin-bottom:24px;color:#fff}
    h3{margin-top:32px;margin-bottom:16px;font-size:20px;color:#fff;display:flex;align-items:center;gap:10px}
    p{margin-bottom:18px;color:var(--muted);font-size:16px}
    
    /* Code & Technical Blocks */
    .tech-box{background:var(--code-bg);padding:20px;border-radius:12px;border:1px solid rgba(255,255,255,0.08);margin-bottom:24px;font-family:'Fira Code',monospace;font-size:14px;overflow-x:auto}
    code{background:rgba(255,255,255,0.1);padding:2px 6px;border-radius:4px;color:#ff9f43;font-family:'Fira Code',monospace;font-size:0.9em}
    .function-name{color:#61afef;font-weight:bold}
    .variable{color:#e06c75}
    .keyword{color:#c678dd}
    .comment{color:#7f848e;font-style:italic}
    
    /* Defense Tips (Questions) */
    .defense-tip{background:rgba(255, 159, 67, 0.05);border-left:4px solid var(--accent);padding:20px;border-radius:0 12px 12px 0;margin:24px 0;position:relative}
    .defense-tip strong{color:var(--accent);display:block;margin-bottom:8px;font-size:12px;text-transform:uppercase;letter-spacing:1px;font-weight:800}
    
    /* Question Box */
    .qa-box{background:rgba(255,255,255,0.03);border-radius:8px;margin-bottom:16px;border:1px solid rgba(255,255,255,0.05)}
    .qa-q{padding:12px 16px;cursor:pointer;font-weight:600;display:flex;justify-content:space-between;align-items:center}
    .qa-q:hover{background:rgba(255,255,255,0.02)}
    .qa-a{padding:16px;border-top:1px solid rgba(255,255,255,0.05);color:var(--muted);font-size:14px;display:none;background:rgba(0,0,0,0.2)}
    .qa-a.open{display:block}
    
    /* Diagrams (Visual Explanations) */
    .visual-diagram{background:#0d1117;padding:20px;border-radius:12px;margin:20px 0;text-align:center;border:1px dashed #30363d}
    .memory-block{display:inline-block;padding:10px 20px;background:#23272e;border:1px solid #3e4451;border-radius:6px;margin:0 5px;color:#abb2bf;font-size:13px}
    .arrow{display:inline-block;margin:0 10px;color:#61afef;font-size:20px}
    .null-char{color:#e06c75;font-weight:bold}
    
    /* Utility Tags */
    .tag{display:inline-block;padding:4px 10px;border-radius:99px;font-size:11px;font-weight:700;margin-right:8px;text-transform:uppercase;letter-spacing:0.5px}
    .tag.c{background:rgba(97, 175, 239, 0.15);color:#61afef}
    .tag.mem{background:rgba(224, 108, 117, 0.15);color:#e06c75}
    .tag.struct{background:rgba(198, 120, 221, 0.15);color:#c678dd}

    @media(max-width:900px){.container{flex-direction:column;padding:16px}nav{width:100%;position:static;max-height:none}}
  </style>
</head>
<body>

  <header>
    <div class="logo">NM</div>
    <div>
      <h1>Defesa T√©cnica ‚Äî <span style="color:var(--accent)">Naruto no Multiverso</span></h1>
      <div style="font-size:13px;color:var(--muted)">Manual completo de c√≥digo (v.Final)</div>
    </div>
  </header>

  <div class="container">
    <nav>
      <div class="nav-card">
        <ul class="nav-list" id="navList">
          <li><button class="active" data-target="intro">1. Arquitetura (Main & Tela)</button></li>
          <li><button data-target="data">2. Dados: CSV vs Bin√°rio</button></li>
          <li><button data-target="memory">3. Mem√≥ria: Realloc & Fallback</button></li>
          <li><button data-target="cinematic">4. Cinem√°tica & Parsing</button></li>
          <li><button data-target="gameplay">5. Gameplay & Raylib</button></li>
          <li><button data-target="build">6. Makefile & Build</button></li>
          <li><button data-target="questions-whatif">7. Perguntas: "E se...?"</button></li>
          <li><button data-target="questions-funcs">8. Perguntas: Fun√ß√µes</button></li>
          <li><button data-target="closing">9. Conclus√£o</button></li>
        </ul>
      </div>
      <div style="margin-top:20px;font-size:12px;color:var(--muted);text-align:center">
        üí° Clique nas perguntas das p√°ginas 7 e 8 para ver as respostas.
      </div>
    </nav>

    <main>
      
      <!-- 1. INTRO -->
      <section id="intro" class="active">
        <div class="nav-card">
          <h2>1. Arquitetura Principal (M√°quina de Estados)</h2>
          <p>O <code>main.c</code> n√£o √© apenas um loop simples. Ele implementa uma <strong>M√°quina de Estados Finita</strong> para gerenciar as telas.</p>
          
          <div class="tech-box">
            <span class="keyword">typedef enum</span> { <br>
            &nbsp;&nbsp;TELA_MENU_INICIAL,<br>
            &nbsp;&nbsp;TELA_CINEMATICA,<br>
            &nbsp;&nbsp;TELA_JOGO,<br>
            &nbsp;&nbsp;TELA_TRANSICAO...<br>
            } <span class="variable">EstadoTela</span>;
            <br><br>
            <span class="keyword">while</span> (!WindowShouldClose()) {<br>
            &nbsp;&nbsp;<span class="keyword">switch</span> (telaAtual) { ... }<br>
            }
          </div>

          <div class="defense-tip">
            <strong>üí° D√∫vida T√©cnica: "Como o jogo transita entre telas?"</strong>
            <p>"Usamos a vari√°vel <code>telaAtual</code>. Quando o jogador clica em 'Iniciar', mudamos essa vari√°vel para <code>TELA_MENU</code>. Quando vence o jogo, mudamos para <code>TELA_RESULTADO</code>. O loop principal detecta essa mudan√ßa no pr√≥ximo frame e desenha a fun√ß√£o correta."</p>
          </div>
        </div>
      </section>

      <!-- 2. DADOS -->
      <section id="data">
        <div class="nav-card">
          <h2>2. Manipula√ß√£o de Arquivos (Texto vs Bin√°rio)</h2>
          <p>Nosso projeto usa <strong>dois tipos</strong> de manipula√ß√£o de arquivos, o que √© um grande diferencial t√©cnico.</p>

          <h3>A. Arquivos de Texto (CSV)</h3>
          <p>Usado para carregar as palavras (Leitura humana). Arquivo: <code>assets/palavras.csv</code>.</p>
          <div class="tech-box">
            <span class="function-name">fgets</span>(linha...); <span class="comment">// L√™ linha</span><br>
            <span class="function-name">strtok</span>(linha, <span class="variable">","</span>); <span class="comment">// Quebra nas v√≠rgulas</span>
          </div>

          <h3>B. Arquivos Bin√°rios (Save Game)</h3>
          <p>Usado para salvar o progresso das fases. Arquivo: <code>progresso.dat</code>.</p>
          <div class="tech-box">
            <span class="function-name">fwrite</span>(estado->progressoFases, <span class="keyword">sizeof</span>(<span class="keyword">int</span>), 6, arquivo);
          </div>

          <div class="defense-tip">
            <strong>üí° Por que usar Bin√°rio (.dat) para o save?</strong>
            "Usamos <code>fwrite</code> bin√°rio para o progresso porque √© mais seguro (o usu√°rio n√£o consegue editar facilmente no bloco de notas para desbloquear fases) e √© muito mais r√°pido para salvar arrays inteiros de uma vez, sem precisar converter para texto."
          </div>
        </div>
      </section>

      <!-- 3. MEMORIA -->
      <section id="memory">
        <div class="nav-card">
          <h2>3. Robustez e Mem√≥ria</h2>
          <p>An√°lise do arquivo <code>palavras.c</code>.</p>

          <h3>O Sistema de Fallback (Seguran√ßa)</h3>
          <p>O c√≥digo possui uma "rede de seguran√ßa" incr√≠vel em <code>carregarPalavrasIniciais</code>.</p>
          <div class="tech-box">
            <span class="keyword">if</span> (<span class="function-name">carregarPalavrasCSV</span>(...)) <span class="keyword">return</span>;<br>
            <br>
            <span class="comment">// Se o CSV falhar, carrega hardcoded:</span><br>
            <span class="function-name">adicionarPalavraDireta</span>(..., <span class="variable">"Goku"</span>, ...);
          </div>
          
          <div class="defense-tip">
             <strong>üí° Ponto de Defesa: Robustez</strong>
             <p>"Se algu√©m deletar acidentalmente a pasta assets, o jogo <strong>n√£o crasha</strong>. Ele detecta a falha no <code>fopen</code> e carrega automaticamente uma lista de palavras padr√£o que est√° compilada dentro do execut√°vel. Isso garante a experi√™ncia do usu√°rio."</p>
          </div>

          <h3>Realloc em a√ß√£o</h3>
          <p>A fun√ß√£o <code>adicionarPalavraDireta</code> usa <code>realloc</code> para aumentar o vetor de palavras dinamicamente, permitindo que o jogo tenha 10 ou 1000 palavras sem mudar o c√≥digo.</p>
        </div>
      </section>

      <!-- 4. CINEMATICA -->
      <section id="cinematic">
        <div class="nav-card">
          <h2>4. Cinem√°tica e Parsing de Texto</h2>
          <p>Em <code>cinematica.c</code>, temos uma l√≥gica interessante para os di√°logos.</p>

          <div class="tech-box">
            "NARRADOR: Elimur... de outro universo,<span class="variable">|</span>surge com um plano..."
          </div>

          <div class="visual-diagram">
            <div style="margin-bottom:10px;font-weight:bold;color:#fff">Quebra de Linha Manual</div>
            <p style="font-size:13px;color:var(--muted)">O Raylib b√°sico n√£o quebra linhas automaticamente em caixas de di√°logo.</p>
            <div style="font-family:'Fira Code'; font-size:12px;">
              <span class="function-name">strtok</span>(buffer, <span class="variable">"|"</span>);
            </div>
          </div>

          <div class="defense-tip">
             <strong>üí° O Truque do Pipe (|)</strong>
             "Para controlar exatamente onde o texto quebra dentro da caixa de di√°logo, usamos o caractere `|` como marcador. O c√≥digo usa <code>strtok</code> para dividir a string nesse caractere e desenha cada peda√ßo em uma coordenada Y diferente (<code>y += 26</code>)."
          </div>
        </div>
      </section>

      <!-- 5. GAMEPLAY -->
      <section id="gameplay">
        <div class="nav-card">
          <h2>5. Gameplay (Jogo.c e Interface.c)</h2>
          
          <h3>Teclado Virtual e Mouse</h3>
          <p>Em <code>interface.c</code>, a fun√ß√£o <code>verificarCliqueTeclado</code> usa colis√£o geom√©trica.</p>
          <div class="tech-box">
            <span class="function-name">CheckCollisionPointRec</span>(posicaoMouse, teclaRect)
          </div>
          <p>Isso verifica se o ponto X,Y do mouse est√° dentro do ret√¢ngulo da tecla. Simples e eficiente.</p>

          <h3>L√≥gica do Wordle</h3>
          <p>O feedback de cores (Verde/Amarelo) √© calculado na fun√ß√£o <code>fazerTentativa</code> em <code>jogo.c</code>. Note que ela atualiza tanto o grid quanto a cor das teclas no teclado virtual.</p>
        </div>
      </section>

      <!-- 6. MAKEFILE -->
      <section id="build">
        <div class="nav-card">
          <h2>6. Makefile e Compila√ß√£o</h2>
          <p>Nosso Makefile √© inteligente e detecta o Sistema Operacional.</p>

          <div class="tech-box">
            <span class="keyword">ifeq</span> ($(OS),Windows_NT)<br>
            &nbsp;&nbsp;LDFLAGS = -Llibwin -lraylib...<br>
            <span class="keyword">else</span><br>
            &nbsp;&nbsp;LDFLAGS = -Llib -lraylib...
          </div>

          <div class="defense-tip">
             <strong>üí° D√∫vida T√©cnica: "Como compilar em PCs diferentes?"</strong>
             <p>"O Makefile verifica a vari√°vel de ambiente do sistema. Se for Windows, ele linka com as bibliotecas da pasta <code>libwin</code> e usa comandos como <code>mkdir</code>. Se for Linux/Mac, ele usa a pasta <code>lib</code> e comandos Unix como <code>rm -rf</code>. Isso torna o projeto port√°vel."</p>
          </div>
        </div>
      </section>

      <!-- 7. QUESTIONS: WHAT IF -->
      <section id="questions-whatif">
        <div class="nav-card">
          <h2>7. Perguntas: "O que acontece se..." (Curiosidades)</h2>
          <p>Poss√≠veis perguntas capciosas que testam se voc√™ realmente entende o que o c√≥digo faz.</p>

          <div class="qa-box">
            <div class="qa-q">1. O que acontece se eu apagar o arquivo progresso.dat? <span style="color:var(--accent)">+</span></div>
            <div class="qa-a">
              "Na fun√ß√£o <code>carregarProgresso</code> (jogo.c), temos uma verifica√ß√£o <code>if (arquivo == NULL)</code>. Se o arquivo n√£o existir (foi apagado), o c√≥digo entende que √© um novo jogo, reseta todas as vari√°veis e libera apenas a Fase 1. O jogo n√£o trava."
            </div>
          </div>

          <div class="qa-box">
            <div class="qa-q">2. E se eu adicionar uma palavra muito grande no CSV? <span style="color:var(--accent)">+</span></div>
            <div class="qa-a">
              "Definimos na struct <code>Palavra</code> que o tamanho m√°ximo √© 30 chars. Ao ler o CSV, usamos a fun√ß√£o <code>strncpy</code> limitando a c√≥pia para <code>sizeof(palavra) - 1</code>. Isso corta o excesso da palavra e previne o <strong>Buffer Overflow</strong>, que poderia corromper a mem√≥ria do jogo."
            </div>
          </div>

          <div class="qa-box">
            <div class="qa-q">3. O que acontece se a gente n√£o der UnloadTexture? <span style="color:var(--accent)">+</span></div>
            <div class="qa-a">
              "Ocorre um <strong>Memory Leak (Vazamento de Mem√≥ria)</strong> na VRAM (GPU). Se trocarmos de tela muitas vezes sem descarregar as imagens anteriores, a mem√≥ria de v√≠deo vai encher at√© o jogo travar ou fechar sozinho. Por isso criamos a fun√ß√£o <code>descarregarRecursosCinematica</code>."
            </div>
          </div>

          <div class="qa-box">
            <div class="qa-q">4. Se eu mudar a ordem das fases na struct EstadoTela? <span style="color:var(--accent)">+</span></div>
            <div class="qa-a">
              "Se voc√™ mudar a ordem no <code>enum</code>, precisa atualizar a ordem no <code>switch(telaAtual)</code> no <code>main.c</code>. Se n√£o fizer isso, o bot√£o 'Cr√©ditos' pode acabar levando para 'Instru√ß√µes', por exemplo, pois os enums s√£o apenas n√∫meros inteiros por baixo dos panos (0, 1, 2...)."
            </div>
          </div>

          <div class="qa-box">
            <div class="qa-q">5. O que acontece se alterar a struct Palavra e carregar um save antigo? <span style="color:var(--accent)">+</span></div>
            <div class="qa-a">
              "O save <code>progresso.dat</code> usa grava√ß√£o bin√°ria crua (fwrite). Se alterarmos a estrutura dos dados no c√≥digo, o layout da mem√≥ria muda. Ao tentar ler um arquivo antigo, os bytes n√£o v√£o bater e os dados vir√£o corrompidos (lixo de mem√≥ria). Seria necess√°rio apagar o save antigo."
            </div>
          </div>
        </div>
      </section>

      <!-- 8. QUESTIONS: FUNCTIONS -->
      <section id="questions-funcs">
        <div class="nav-card">
          <h2>8. Perguntas: "Para que serve essa fun√ß√£o?"</h2>
          <p>Explica√ß√£o t√©cnica de fun√ß√µes espec√≠ficas do C que est√£o no seu c√≥digo.</p>

          <div class="qa-box">
            <div class="qa-q">memset(estado, 0, sizeof(EstadoJogo)); <span style="color:var(--accent)">+</span></div>
            <div class="qa-a">
              <strong>Local:</strong> jogo.c (inicializarJogo)<br><br>
              "Ela preenche todo o bloco de mem√≥ria da vari√°vel com zeros. Isso √© crucial para garantir que n√£o haja 'lixo de mem√≥ria' (valores aleat√≥rios que estavam na RAM) nas nossas vari√°veis. Garante que <code>venceu = 0</code>, <code>tentativaAtual = 0</code>, etc."
            </div>
          </div>

          <div class="qa-box">
            <div class="qa-q">strtok(NULL, "|"); <span style="color:var(--accent)">+</span></div>
            <div class="qa-a">
              <strong>Local:</strong> cinematica.c<br><br>
              "O <code>strtok</code> divide uma string em peda√ßos. Na primeira vez chamamos com a string. Nas vezes seguintes, passamos <code>NULL</code> para dizer √† fun√ß√£o: 'continue dividindo a <strong>mesma string</strong> de onde voc√™ parou na chamada anterior'."
            </div>
          </div>

          <div class="qa-box">
            <div class="qa-q">linha[strcspn(linha, "\r\n")] = 0; <span style="color:var(--accent)">+</span></div>
            <div class="qa-a">
              <strong>Local:</strong> palavras.c<br><br>
              "Quando usamos <code>fgets</code> para ler do CSV, ele traz junto o 'Enter' (\n) do final da linha. Essa fun√ß√£o calcula o tamanho da string at√© achar o \n e substitui ele por 0 (null terminator), limpando a string para uso correto."
            </div>
          </div>

          <div class="qa-box">
            <div class="qa-q">GetFrameTime(); <span style="color:var(--accent)">+</span></div>
            <div class="qa-a">
              <strong>Local:</strong> cinematica.c<br><br>
              "Retorna o tempo que o √∫ltimo frame demorou para ser desenhado. Usamos isso para mover o Naruto. Em vez de dizer 'mova 5 pixels por frame', dizemos 'mova X pixels por segundo'. Isso garante que o jogo rode na mesma velocidade em PCs r√°pidos e lentos (Delta Time)."
            </div>
          </div>

          <div class="qa-box">
            <div class="qa-q">realloc(*lista, ...); <span style="color:var(--accent)">+</span></div>
            <div class="qa-a">
              <strong>Local:</strong> palavras.c<br><br>
              "Tenta redimensionar um bloco de mem√≥ria j√° alocado. Se o bloco atual n√£o tiver espa√ßo para crescer vizinho a ele na mem√≥ria, o <code>realloc</code> aloca um novo bloco em outro lugar, copia os dados e libera o antigo. Por isso precisamos atualizar o ponteiro."
            </div>
          </div>
        </div>
      </section>

      <!-- 9. CLOSING -->
      <section id="closing">
        <div class="nav-card">
          <h2>9. Conclus√£o e Pontos Fortes</h2>
          <p>Resumo estrat√©gico para encerrar sua apresenta√ß√£o com chave de ouro.</p>
          
          <ul>
            <li><strong>Separa√ß√£o de Responsabilidades:</strong> C√≥digo dividido logicamente em M√≥dulos (Jogo, Interface, Cinem√°tica, Palavras), facilitando manuten√ß√£o.</li>
            <li><strong>Persist√™ncia de Dados H√≠brida:</strong> CSV para configura√ß√£o (f√°cil edi√ß√£o por humanos) e Bin√°rio para Save (seguran√ßa e performance).</li>
            <li><strong>Robustez (Fallback):</strong> O jogo possui sistema de backup interno. Se os arquivos externos falharem, ele usa dados compilados para n√£o travar.</li>
            <li><strong>Gerenciamento de Mem√≥ria:</strong> Uso consciente de aloca√ß√£o din√¢mica e limpeza de recursos gr√°ficos.</li>
          </ul>
          
          <div class="defense-tip" style="border-color:#2ecc71; background:rgba(46, 204, 113, 0.1)">
             <strong style="color:#2ecc71">üí° Destaque Final: Escalabilidade</strong>
             <p>"A estrutura do c√≥digo permite adicionar novas fases apenas adicionando linhas no CSV e uma imagem na pasta assets, sem precisar recompilar todo o c√≥digo para adicionar conte√∫do simples. O projeto est√° pronto para crescer."</p>
          </div>
        </div>
      </section>

    </main>
  </div>

  <script>
    // Navega√ß√£o
    const buttons = document.querySelectorAll('.nav-list button');
    const sections = document.querySelectorAll('main section');

    buttons.forEach(btn => {
      btn.addEventListener('click', () => {
        buttons.forEach(b => b.classList.remove('active'));
        sections.forEach(s => s.classList.remove('active'));
        btn.classList.add('active');
        const targetId = btn.getAttribute('data-target');
        document.getElementById(targetId).classList.add('active');
        window.scrollTo({top: 0, behavior: 'smooth'});
      });
    });

    // Toggle para Perguntas e Respostas
    const qas = document.querySelectorAll('.qa-q');
    qas.forEach(q => {
      q.addEventListener('click', () => {
        const answer = q.nextElementSibling;
        answer.classList.toggle('open');
        const symbol = q.querySelector('span');
        symbol.textContent = answer.classList.contains('open') ? '-' : '+';
      });
    });
  </script>
</body>
</html>
